panel = panel.smooth, rows = 1)
?mtcars
pairs(mtcars)
y <- mtcars$cyl
x <- as.factor(mtcars$am)
plot(x,y)
y <- mtcars$cyl
x <- mtcars$am
plot(x,y)
smoothScatter(x,y)
str(data)
y <- mtcars$disp
x <- mtcars$am
smoothScatter(x,y)
y <- mtcars$hp
x <- mtcars$am
smoothScatter(x,y)
lm(y,x)
lm(y~x)
summary(lm(y~x))$coeff
str(data)
y <- mtcars$drat
x <- mtcars$am
smoothScatter(x,y)
y <- mtcars$wt
x <- mtcars$am
smoothScatter(x,y)
y <- mtcars$qsec
x <- mtcars$am
smoothScatter(x,y)
y <- mtcars$vs
x <- mtcars$am
smoothScatter(x,y)
y <- mtcars$gear
x <- mtcars$am
smoothScatter(x,y)
y <- mtcars$carb
x <- mtcars$am
smoothScatter(x,y)
y <- mtcars$mpg
x <- as.factor(mtcars$am)
plot(x,y)
y <- mtcars$wt
x <- mtcars$am
smoothScatter(x,y)
y <- mtcars$mpg
x <- mtcars$wt
smoothScatter(x,y)
summary(lm(y~data[,1:3]))$coeff
summary(lm(mpg~., data="mtcars"))$coeff
summary(lm(mpg~. data="mtcars"))$coeff
summary(lm(mpg~. data=mtcars))$coeff
lm(mpg~am, data=mtcars)
lm(mpg~., data=mtcars)
summary(lm(mpg~., data=mtcars))$coeff
summary(lm(mpg~wt, data=mtcars))$coeff
summary(lm(mpg~wt+am, data=mtcars))$coeff
summary(lm(mpg~am, data=mtcars))$coeff
summary(lm(mpg~cyl, data=mtcars))$coeff
summary(lm(wt~cyl, data=mtcars))$coeff
summary(lm(mpg~wt+cyl, data=mtcars))$coeff
summary(lm(mpg~am, data=mtcars))$coeff
summary(lm(mpg~wt+am, data=mtcars))$coeff
fit1 <- lm(mpg~am, data=mtcars)
res1 <- resid(fit1)
plot(res1)
fit2 <- lm(mpg~wt+am, data=mtcars)
res2 <- resid(fit2)
plot(res2)
cor(mtcars, use="complete.obs", method="kendall")
cor1 <- cor(mtcars, use="complete.obs", method="kendall")[,c(1,9)]
cor1
cov(mtcars, use="complete.obs")
summary(lm(mpg~wt+am, data=mtcars))$coeff
summary(lm(mpg~am+wt, data=mtcars))$coeff
summary(lm(mpg~am, data=mtcars))$coeff
summary(lm(i(1/mpg)~am, data=mtcars))$coeff
rm(list = ls())
summary(lm(I(1/mpg)~am, data=mtcars))$coeff
summary(lm(mpg~am, data=mtcars))$coeff
summary(lm(mpg~wt+am, data=mtcars))$coeff
summary(lm(I(1/mpg)~wt+am, data=mtcars))$coeff
plot(mtcars$wt, mtcars$mpg)
cor1 <- cor(mtcars, use="complete.obs", method="kendall")[,c(1,9)]
cor1
require(GGally); require(ggplot2)
install.packages(GGally)
install.packages("GGally")
require(GGally); require(ggplot2)
ggpairs(mtcars, lower=list(continous="smooth", params = c(method = "loess")))
ggpairs(mtcars, lower = list(continuous = "smooth"),params = c(method = "loess"))
ggpairs(mtcars, lower = list(continuous = "smooth"))
fit1 <- lm(mpg~am, data = mtcars)
summary(fit1)$coeff
```
fit1 <- lm(mpg~am, data = mtcars)
fit1
summary(fit1)$coeff
?mtcars
manual
y <- mtcars$wt
x <- mtcars$am
plot(x,y)
y <- mtcars$mpg
x <- as.factor(mtcars$am)
plot(x,y)
cor1 <- cor(mtcars, use="complete.obs", method="kendall")[,c(1,9)]
cor1
cor1 <- cor(mtcars, use="complete.obs", method="kendall")
cor1
fit1 <- lm(mpg~cyl, data=mtcars)
summary(fit1)$coef
fit1 <- lm(mpg~disp, data=mtcars)
summary(fit1)$coef
fit1 <- lm(mpg~hp, data=mtcars)
summary(fit1)$coef
fit1 <- lm(mpg~cyl+disp+hp, data=mtcars)
summary(fit1)$coef
fit1 <- lm(mpg~wt+cyl+disp+hp, data=mtcars)
summary(fit1)$coef
fit1 <- lm(mpg~wt, data=mtcars)
summary(fit1)$coef
fit1 <- lm(mpg~., data=mtcars)
summary(fit1)$coef
summary(fit1)
fit1 <- lm(mpg~wt, data=mtcars)
summary(fit1)
fit1 <- lm(mpg~wt+1, data=mtcars)
summary(fit1)
fit1 <- lm(mpg~wt+cyl, data=mtcars)
summary(fit1)
fit1 <- lm(mpg~wt+cyl+hp, data=mtcars)
summary(fit1)
fit1 <- lm(mpg~wt+cyl+disp, data=mtcars)
summary(fit1)
fit1 <- lm(mpg~wt+disp, data=mtcars)
summary(fit1)
fit1 <- lm(mpg~wt+hp, data=mtcars)
summary(fit1)
y <- mtcars$mpg
x <- as.factor(mtcars$am)
plot(x,y)
library(MASS)
fittest <- lm(mpg~wt+am+disp,data=mtcars)
step <- stepAIC(fittest, direction="both")
step$anova # display results
fittest <- lm(mpg~cyl+disp+hp+drat+wt+qsec+vs+am+gear+carb,data=mtcars)
step <- stepAIC(fittest, direction="both")
step$anova # display results
str(mtcars)
?mtcars
library(MASS)
fit3 <- lm(mpg~cyl+disp+hp+drat+wt+vs+am+gear+carb,data=mtcars)
step <- stepAIC(fit3, direction="both")
step$anova
step
library(MASS)
fit3 <- lm(mpg~cyl+disp+drat+wt+vs+am+gear+carb,data=mtcars)
step <- stepAIC(fit3, direction="both")
step$anova
fit4 <- lm(mpg ~ cyl + wt + carb, data = mtcars)
summary(fit4)$coef
fit4 <- lm(mpg ~ cyl + hp + wt, data = mtcars)
summary(fit4)$coef
summary(fit4)
summary(fit5)
fit5 <- lm(mpg ~ cyl + wt + carb, data = mtcars)
summary(fit5)
fit6 <- lm(mpg~cyl+wt, data=mtcars)
summary(fit6)
library(MASS)
fit3 <- lm(mpg~cyl+disp+drat+wt+vs+am+gear+carb,data=mtcars)
step <- stepAIC(fit3, direction="both")
step$anova
library(MASS)
fit3 <- lm(mpg~cyl+disp+hp+drat+wt+vs+am+gear+carb,data=mtcars)
step <- stepAIC(fit3, direction="both")
step$anova
str(step)
step$coef
library(MASS)
fit3 <- lm(mpg~cyl+disp+hpdrat+wt+vs+am+gear+carb,data=mtcars)
step <- stepAIC(fit3, direction="both")
step$anova
*Table3: Ouput of stepwise regression on the available variables (qsec disregarded)*
fit4 <- lm(mpg~cyl+hp+wt)
summary(fit4)$coef
fit4 <- lm(mpg~cyl+hp+wt, data=mtcars)
summary(fit4)$coef
fit5 <- lm(mpg~cyl+wt, data=mtcars)
summary(fit5)$coef
resid <- resid(fit5)
plot(resid)
library(MASS)
fit3 <- lm(mpg~cyl+disp+hp+drat+wt+vs+am+gear+carb,data=mtcars)
step <- stepAIC(fit3, direction="both")
step$anova
library(MASS)
fit3 <- lm(mpg~cyl+disp+hp+drat+wt+vs+am+gear+carb,data=mtcars)
stepAIC(fit3, direction="both")$anova
step <- stepAIC(fit3, direction="both")
library(MASS)
fit3 <- lm(mpg~cyl+disp+hp+drat+wt+vs+am+gear+carb,data=mtcars)
step <- stepAIC(fit3, direction="both", trace=FALSE)
step$anova
```
par(mfrow=c(2,2))
plot(fit5)
round(dfbetas(fit5)[1:10,2])
round(dfbetas(fit5)[1:10,2],3)
round(dfbetas(fit5)[1:10,2],3)
round(hatvalues(fit5)[1:10,2],3)
round(dfbetas(fit5)[1:10,2],3)
round(hatvalues(fit5)[1:10],3)
```
?dfbetas
dfbetas(fit5)
round(dfbetas(fit5),2)
diag1 <- round(dfbetas(fit5)[1:10,2],3)
plot(diag1[,1])
diag1[,1]
str(diag1)
diag1
diag1 <- round(dfbetas(fit5),3)
str(diag1)
diag1
diag1$(Intercept)
diag1$1
diag1[,1]
plot(diag1[,1])
plot(diag1)
diag1 <- abs(diag1)
diag1
sort1 <- sort(diag1)
sort1
diag2 <- round(hatvalues(fit5),3)
diag2
as.list(diag2)
plot(diag2)
par(mfrow=c(2,2))
plot(diag1[,1])
plot(diag1[,2])
plot(diag1[,3])
plot(diag2)
str(mtcars)
summary(fit5)
summary(fit5)
round(dfbetas(fit5),3)
round(hatvalues(fit5),3)
avg(diag2)
mean(diag2)
summary(fit5)$coef
summary(fit1)$coef
fit1 <- lm(mpg~am, data = mtcars)
summary(fit1)$coeff
?mtcars
par(mfrow=c(2,2)); plot(fit5)
install.packages("caret")
?iterators
??iterators
gbm
required("MASS")
require("MASS")
library(AppliedPredictiveModeling)
data(AlzheimerDisease)
install.packages("AppliedPredictiveModeling")
install.packages("AppliedPredictiveModeling")
library(AppliedPredictiveModeling)
data(concrete)
library(caret)
set.seed(1000)
inTrain = createDataPartition(mixtures$CompressiveStrength, p = 3/4)[[1]]
training = mixtures[ inTrain,]
testing = mixtures[-inTrain,]
head(training)
str(training)
plot(training$CompressiveStrength)
g <- ggplot(training, aes(CompressiveStrength))
g + geom_point(aes(colour = Flyash))
g + geom_point(aes(colour = FlyAsh))
seq(1)
seq(1:10)
training$recnr <- seq(1:nrow(training))
str(training)
g <- ggplot(training, aes(recnr,CompressiveStrength))
g + geom_point(aes(colour = FlyAsh))
g + geom_point(aes(colour = Age))
g + geom_point(aes(colour = Cement))
g + geom_point(aes(colour = Water))
g + geom_point(aes(colour = Superplasticize))
g + geom_point(aes(colour = Superplasticizer))
g + geom_point(aes(colour = CoarseAggregate))
g + geom_point(aes(colour = FineAggregate))
g + geom_point(aes(colour = FlyAsh))
library(AppliedPredictiveModeling)
data(concrete)
library(caret)
set.seed(1000)
inTrain = createDataPartition(mixtures$CompressiveStrength, p = 3/4)[[1]]
training = mixtures[ inTrain,]
testing = mixtures[-inTrain,]
hist(training$Superplasticizer)
log(0)
summary(training)
library(AppliedPredictiveModeling)
data(concrete)
library(caret)
set.seed(1000)
inTrain = createDataPartition(mixtures$CompressiveStrength, p = 3/4)[[1]]
training = mixtures[ inTrain,]
testing = mixtures[-inTrain,]
str(training)
training$recnr <- seq(1:nrow(training))
g <- ggplot(training, aes(recnr,CompressiveStrength))
g + geom_point(aes(colour = FlyAsh))
g
g + geom_point(aes(colour = Age))
g + geom_point(aes(colour = FlyAsh))
library(AppliedPredictiveModeling)
data(concrete)
library(caret)
set.seed(1000)
inTrain = createDataPartition(mixtures$CompressiveStrength, p = 3/4)[[1]]
training = mixtures[ inTrain,]
testing = mixtures[-inTrain,]
hist(training$Superplasticizer)
install.packages("rattle")
install.packages("RGtk2")
fancyRpartPlot(fit1$finalModel)
library(rattle)
fancyRpartPlot(fit1$finalModel)
require(rattle)
fancyRpartPlot(fit1$finalModel)
?rattle
??rattle
plot(fit1$finalModel, uniform=TRUE, main="Classification Tree")
text(fit1$finalModel, use.n=TRUE, all=TRUE, cex=.8)
fit1 <- train(Class~.,method = "rpart", data=testset)
print(fit1$finalModel)
plot(fit1$finalModel, uniform=TRUE, main="Classification Tree")
text(fit1$finalModel, use.n=TRUE, all=TRUE, cex=.8)
plot(fit1$finalModel, uniform=TRUE,
main="Classification Tree")
text(fit1$finalModel, use.n=TRUE, all=TRUE, cex=.8)
?text
plot(fit1$finalModel, uniform=TRUE,
main="Classification Tree")
text(fit1$finalModel, use.n=TRUE, all=TRUE, labels = seq_along(1), cex=.8)
plot(fit1$finalModel)
require(caret); plot(fit1$finalModel)
plot(fit1)
fit1
rm(list = ls())
library(AppliedPredictiveModeling)
data(segmentationOriginal)
library(caret)
data <- segmentationOriginal
testset <- data[data$Case == "Test",]
trainset <- data[data$Case == "Train",]
set.seed(125)
fit1 <- train(Class~.,method = "rpart", data=testset)
fit1
print(fit1$finalModel)
library(rattle)
fancyRpartPlot(modFit$finalModel)
library(rattle); library(RGtk2)
fancyRpartPlot(modFit$finalModel)
plot(fit1$finalModel, uniform=TRUE,
main="Classification Tree")
text(fit1$finalModel, use.n=TRUE, all=TRUE, cex=.8)
prp(fit1)
plot(fit1$finalModel, uniform=TRUE,
main="Classification Tree")
text(fit1$finalModel, use.n=TRUE, all=TRUE, cex=.8)
predict(fit1, newdata = testset[testset$TotalIntench2 == 23000])
predict(fit1, newdata = testset[testset$TotalIntench2 == 23000,])
predict(fit1, newdata = testset[testset$TotalIntench2 == 50000,])
predict(fit1, newdata = testset[(testset$TotalIntench2 == 50000)&(testset$FiberWidthCh1 == 10)&testset$PerimStatusCh1==2,])
predict(fit1, newdata = testset[(testset$TotalIntench2 == 23000)&(testset$FiberWidthCh1 == 10)&testset$PerimStatusCh1==2,])
predict(fit1, newdata = testset[(testset$TotalIntench2 == 50000)&(testset$FiberWidthCh1 == 10)&testset$PerimStatusCh1==100,])
p1 <- predict(fit1, newdata = testset[(testset$TotalIntench2 == 23000)&(testset$FiberWidthCh1 == 10)&testset$PerimStatusCh1==2,])
p2 <- predict(fit1, newdata = testset[(testset$TotalIntench2 == 50000)&(testset$FiberWidthCh1 == 10)&testset$PerimStatusCh1==100,])
p1
p1 <- predict(fit1, newdata = testset[(testset$TotalIntench2 == 23000)&(testset$FiberWidthCh1 == 10)&(testset$PerimStatusCh1==2),])
p2 <- predict(fit1, newdata = testset[(testset$TotalIntench2 == 50000)&(testset$FiberWidthCh1 == 10)&(testset$PerimStatusCh1==100),])
p1
p2
t2 <- testset[(testset$TotalIntench2 == 23000)&(testset$FiberWidthCh1 == 10)&(testset$PerimStatusCh1==2),]
t2
testje$aap = 1
testset$TotalIntench2
testset
str(testset)
testset$Case
head(testset)
p1 <- predict(fit1, newdata = testset[(testset$TotalIntenCh2 == 23000)&(testset$FiberWidthCh1 == 10)&(testset$PerimStatusCh1==2),])
p2 <- predict(fit1, newdata = testset[(testset$TotalIntenCh2 == 50000)&(testset$FiberWidthCh1 == 10)&(testset$PerimStatusCh1==100),])
p1
p2
testset$TotalIntenCh2
testset$TotalIntenCh2 == 23000
out1 <- testset$TotalIntenCh2 <- 23000; testset$FiberWidthCh1 <- 10; testset$PerimStatusCh1 <- 2
p1 <- predict(fit1, newdata = out1)
testset$TotalIntenCh2 <- 23000; testset$FiberWidthCh1 <- 10; testset$PerimStatusCh1 <- 2
p1 <- predict(fit1, newdata = testset)
p1
unique(p1)
testset$TotalIntenCh2 <- 23000; testset$FiberWidthCh1 <- 10; testset$PerimStatusCh1 <- 2
p1 <- predict(fit1, newdata = testset); unique(p1)
testset$TotalIntenCh2 <- 50000; testset$FiberWidthCh1 <- 10; testset$VarIntenCh4 <- 100
p2 <- predict(fit1, newdata = testset); unique(p2)
testset$TotalIntenCh2 <- 57000; testset$FiberWidthCh1 <- 8; testset$VarIntenCh4 <- 100
p3 <- predict(fit1, newdata = testset); unique(p3)
testset$FiberWidthCh1 <- 8; testset$VarIntenCh4 <- 100; testset$PerimStatusCh1 <- 2
p4 <- predict(fit1, newdata = testset); unique(p4)
library(ElemStatLearn); library(caret)
data(vowel.train)
data(vowel.test)
vowel.train$y <- as.factor(vowel.train$y)
vowel.test$y <- as.factor(vowel.test$y)
set.seed(33833)
fit1 <- train(y~., method = "rf", data=vowel.train, prox = TRUE)
fit2 <- train(y~., method = "gbm", data=vowel.train)
p1<- predict(fit1, newdata=vowel.test)
vowel.test$rf_right <- p1==vowel.test$y
p2<- predict(fit2, newdata=vowel.test)
vowel.test$gbm_right <- p2==vowel.test$y
table(vowel.test$rf_right)
table(vowel.test$gbm_right)
vowel.test_both <- vowel.test[vowel.test$rf_right==vowel.test$gbm_right,]
table(vowel.test_both$rf_right)
c<-confusionMatrix(p1, vowel.test$y)
rm(list = ls())
library(caret)
library(gbm)
set.seed(3433)
library(AppliedPredictiveModeling)
data(AlzheimerDisease)
adData = data.frame(diagnosis,predictors)
inTrain = createDataPartition(adData$diagnosis, p = 3/4)[[1]]
training = adData[ inTrain,]
testing = adData[-inTrain,]
set.seed(62433)
fit3 <- train(diagnosis~., method = "rf", data=training, prox = TRUE)
fit4 <- train(diagnosis~., method = "gbm", data=training)
fit5 <- train(diagnosis~., method = "lda", data=training)
p3 <- predict(fit3, testing)
p4 <- predict(fit4, testing)
p5 <- predict(fit5, testing)
pred_cp <- data.frame(p3,p4,p5,testing$diagnosis)
fit6<-train(testing.diagnosis~.,method="rf",data=pred_cp, prox=TRUE)
pred_final<-predict(fit6,pred_cp)
confusionMatrix(p3, testing$diagnosis)$overall
confusionMatrix(p4, testing$diagnosis)$overall
confusionMatrix(p5, testing$diagnosis)$overall
confusionMatrix(pred_final, testing$diagnosis)$overall
rm(list = ls())
library(caret)
library(gbm)
set.seed(3433)
library(AppliedPredictiveModeling)
data(AlzheimerDisease)
adData = data.frame(diagnosis,predictors)
inTrain = createDataPartition(adData$diagnosis, p = 3/4)[[1]]
training = adData[ inTrain,]
testing = adData[-inTrain,]
set.seed(62433)
fit3 <- train(diagnosis~., method = "rf", data=training, prox = TRUE)
fit4 <- train(diagnosis~., method = "gbm", data=training)
fit5 <- train(diagnosis~., method = "lda", data=training)
p3 <- predict(fit3, training) #had eerst testing gedaan
p4 <- predict(fit4, training)
p5 <- predict(fit5, training)
pred_cp <- data.frame(p3,p4,p5,diag=training$diagnosis)
fit6<-train(diag~.,method="rf",data=pred_cp, prox=TRUE)
pred_final<-predict(fit6,testing)
p3a <- predict(fit3, testing) #had eerst testing gedaan
p4a <- predict(fit4, testing)
p5a <- predict(fit5, testing)
confusionMatrix(p3a, testing$diagnosis)$overall
confusionMatrix(p4a, testing$diagnosis)$overall
confusionMatrix(p5a, testing$diagnosis)$overall
confusionMatrix(pred_final, testing$diagnosis)$overall
rm(list = ls())
str(fit1)
ls
list=ls()
rm(list)
setwd("D:/Coursera/Course8-4/Coursera_DS_Assignment8-4")
setwd("./data")
load(file = "fit1.RData")
load(file = "fit2.RData")
trainset <- read.csv("HAT_traindata.csv", na.strings=c(""," ","NA"))
valset <- read.csv("HAT_testdata.csv")
trainset2 <- trainset[,colSums(is.na(trainset))<(nrow(trainset)*0.95)]
trainset3 <- subset(trainset2, select=-c(1:7))
library(caret);set.seed(1234)
inTrain = createDataPartition(trainset3$classe, p = 0.8)[[1]]
training = trainset3[ inTrain,]
testing = trainset3[-inTrain,]
p1 <- predict(fit1, testing)
p2 <- predict(fit2, testing)
c1 <- confusionMatrix(p1, testing$classe)
c2 <- confusionMatrix(p2, testing$classe)
c1
2
c2
str(valset)
tail(valset)
p3 <- predict(fit1, valset)
p3
getwd()
